# 🍌 智绘工坊

**智绘工坊** 是一个专为教育场景打造的 AI 素材生成工坊。它不仅仅是一个绘图工具，更是一个集成了教学场景适配、提示词优化、额度管理和内容风控的完整解决方案。

---

## 🌟 核心功能

### 1. 🎨 教学素材生成
*   **学科分类 (Subject)**：支持数学、科学、英语、艺术、历史等分类，生成的图片自动归档。
*   **年级适配 (Grade)**：支持从幼儿园到大学的年级选择，AI 自动调整画风（如低年级更卡通，高年级更写实）。
*   **画质分级**：提供 1K (Standard)、2K (High)、4K (Ultra) 三档画质，自动注入画质增强指令。
*   **多画幅支持**：支持 1:1、16:9 (PPT专用)、9:16 (手机海报)。

### 2. 🪄 智能辅助
*   **Magic Optimize**：内置 Prompt Engineer，一键将简单的词语（如“猫”）扩写为电影级的光影描述。
*   **沉浸式详情页**：点击图片查看完整提示词，支持一键复制，方便教学复盘。

### 3. 🛡️ 管理与风控
*   **防刷限流**：
    *   单 IP 每分钟限生成 1 张。
    *   单 IP 每周限生成 20 张（SQLite 持久化存储，重启不丢失）。
    *   额度不足时引导联系信息组。
*   **图库管理**：
    *   **精选机制**：管理员可对优质图片“加星”，普通用户默认只看到精选图片。
    *   **展示区域**：所有被标记为精选的图片将优先展示在画廊中。

---

## 🚀 生产环境部署 (Production)

### 1. 环境要求
*   **OS**: Linux (推荐 Ubuntu/Debian) 或 macOS
*   **Python**: 3.10+
*   **Node.js**: 18+ (用于构建前端)

### 2. 一键启动
在项目根目录下运行生产环境脚本。脚本会自动构建前端、设置后端虚拟环境并启动服务：

```bash
./run_prod.sh
```

**启动成功后：**
*   脚本会自动检测并显示局域网 IP。
*   **本机访问**: `http://localhost:6060`
*   **局域网访问**: `http://<你的局域网IP>:6060` (例如 `http://192.168.1.10:6060`)

### 3. 设置开机自启动 (Linux/macOS)
支持将服务注册为系统服务 (Systemd on Linux, Launchd on macOS)，实现开机自动后台运行。

**安装自启动服务：**
```bash
# Linux (需要 sudo)
sudo ./run_prod.sh --install-startup

# macOS
./run_prod.sh --install-startup
```

> **注意**：自启动模式下，服务会自动附带 `--no-build` 参数，跳过前端构建步骤以加快启动速度。如果你更新了前端代码，请手动运行一次 `./run_prod.sh` 重新构建。

**管理服务 (Linux)：**
```bash
# 查看状态
systemctl status nano-banana.service

# 重启服务
sudo systemctl restart nano-banana.service

# 查看日志
journalctl -u nano-banana.service -f
```

---

## 🛠️ 开发环境 (Development)

如果你是开发者，需要实时调试代码：

```bash
./run_dev.sh
```

此脚本会启动带有热重载功能的开发服务器：
*   后端 API: `http://localhost:8000` (Docs: `/docs`)
*   前端页面: `http://localhost:5173`

---

## 📁 目录结构说明

```text
nano-banana-studio/
├── run_prod.sh             # 生产环境启动与部署脚本
├── run_dev.sh              # 开发环境启动脚本
├── backend/                # Python 后端 (FastAPI)
│   ├── main.py             # API 入口
│   ├── core/               # 核心逻辑 (AI生成、限流等)
│   └── static/generated/   # 图片存储区
└── frontend/               # Vue3 前端
    └── dist/               # 构建后的静态文件 (由 run_prod.sh 生成)
```

---

## 📊 管理员手册

### 数据统计
登录管理员后，点击顶部的 **📊 报表图标**，可查看：
*   各学科生成热度
*   各年级使用分布
*   活跃 IP 排行榜

### 图片管理
在“学科画廊”中，管理员可以看到每张图片右上角的 **☆ 星星**：
*   **点亮星星**：设为精选（Featured），作为展示图片。
*   **熄灭星星**：取消精选。
*   **过滤开关**：侧边栏底部有“只看精选”开关，方便预览学生视角。

---

## 📞 支持与联系
**Copyright © 上海科技大学附属学校信息组**
如需调整额度或报告问题，请联系信息组老师。